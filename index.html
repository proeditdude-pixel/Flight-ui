<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>CX_IFE_V5_COMPLETE</title>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;800&display=swap" rel="stylesheet">

<style>
  :root { --pry: #006564; --sec: #c6a87c; --bg: #000000; --sur: #121212; --txt: #e0e0e0; }
  body { margin: 0; background: var(--bg); color: var(--txt); font-family: 'Inter', sans-serif; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
  
  /* --- LAYOUT --- */
  .app { display: flex; flex: 1; height: 100%; overflow: hidden; }
  
  /* Sidebar / Bottom Nav */
  .sidebar { width: 80px; background: #080808; border-right: 1px solid #222; display: flex; flex-direction: column; align-items: center; padding: 20px 0; z-index: 50; }
  .logo { width: 40px; height: 40px; object-fit: contain; margin-bottom: 20px; }
  
  .nav-item { width: 50px; height: 50px; border-radius: 12px; display: flex; flex-direction: column; justify-content: center; align-items: center; color: #666; cursor: pointer; margin-bottom: 10px; transition: .2s; }
  .nav-item.active { background: var(--pry); color: #fff; box-shadow: 0 0 15px var(--pry); }
  .nav-item i { font-size: 18px; margin-bottom: 4px; }
  .nav-item span { font-size: 8px; text-transform: uppercase; font-weight: 700; }

  /* Main Area */
  .main { flex: 1; position: relative; display: flex; flex-direction: column; background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%); overflow: hidden; }
  .header { height: 60px; border-bottom: 1px solid #222; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; background: rgba(0,0,0,0.8); }
  .flight-info { font-weight: 800; font-size: 18px; color: var(--sec); }
  .stats-bar { display: flex; gap: 10px; font-size: 11px; color: #888; }
  
  /* Views */
  .view { display: none; padding: 20px; height: 100%; overflow-y: auto; padding-bottom: 100px; box-sizing: border-box; }
  .view.active { display: block; animation: fade In 0.3s; }
  @keyframes fade { from {opacity:0} to {opacity:1} }

  /* CHAT STYLES */
  .chat-box { height: calc(100% - 60px); overflow-y: auto; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; padding: 10px; display: flex; flex-direction: column; }
  .chat-msg { margin-bottom: 8px; font-size: 13px; word-wrap: break-word; }
  .chat-msg b { color: var(--sec); margin-right: 5px; }
  .chat-input-area { display: flex; height: 50px; margin-top: 10px; }
  .chat-input-area input { flex: 1; background: #222; border: 1px solid #333; color: #fff; padding: 10px; border-radius: 4px 0 0 4px; }
  .chat-input-area button { width: 70px; background: var(--pry); border: none; color: #fff; font-weight: 700; border-radius: 0 4px 4px 0; cursor: pointer; }

  /* MOBILE RESPONSIVE */
  @media (max-width: 768px) {
    .app { flex-direction: column-reverse; }
    .sidebar { width: 100%; height: 70px; flex-direction: row; justify-content: space-around; padding: 0; border-right: none; border-top: 1px solid #333; background: #000; }
    .logo { display: none; }
    .nav-item { margin: 0; height: 100%; width: 100%; border-radius: 0; background: transparent; }
    .nav-item.active { box-shadow: inset 0 -3px 0 var(--pry); background: #111; }
    .stats-bar span { display: none; } 
    .stats-bar b { display: block; }
  }

  /* SETTINGS PANEL */
  .admin-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #111; z-index: 999; display: none; flex-direction: column; }
  .admin-overlay.open { display: flex; }
  .adm-header { padding: 20px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; background: #000; }
  .adm-content { flex: 1; overflow-y: auto; padding: 20px; }
  .adm-group { margin-bottom: 20px; background: #1a1a1a; padding: 15px; border-radius: 8px; border: 1px solid #333; }
  .adm-group h4 { margin: 0 0 10px 0; color: var(--sec); font-size: 12px; text-transform: uppercase; }
  .inp-row { margin-bottom: 10px; }
  .inp-row label { display: block; font-size: 10px; color: #888; margin-bottom: 5px; }
  input, select { width: 100%; background: #000; border: 1px solid #333; color: #fff; padding: 10px; border-radius: 4px; box-sizing: border-box; }
  .btn { width: 100%; padding: 12px; background: var(--pry); border: none; color: #fff; font-weight: 700; cursor: pointer; border-radius: 4px; margin-top: 5px; }

  /* CARDS (Movies & Games) */
  .grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; }
  .card { background: var(--sur); border-radius: 8px; overflow: hidden; position: relative; }
  .card img { width: 100%; height: 120px; object-fit: cover; }
  .card-info { padding: 10px; font-size: 12px; }
  .game-badge { position: absolute; top: 5px; right: 5px; background: var(--pry); color: #fff; font-size: 9px; padding: 3px 6px; border-radius: 4px; }

  /* VIDEO MODAL */
  .vid-mod { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 1000; display: none; flex-direction: column; }
  .vid-head { padding: 15px; text-align: right; background: #111; }
  iframe { flex: 1; border: none; }
</style>
</head>
<body>

<div class="app">
  <div class="sidebar">
    <img id="ui_logo" class="logo" src="">
    <div class="nav-item active" onclick="nav('home', this)"><i class="fas fa-home"></i><span>Home</span></div>
    <div class="nav-item" onclick="nav('watch', this)"><i class="fas fa-film"></i><span>Watch</span></div>
    <div class="nav-item" onclick="nav('game', this)"><i class="fas fa-gamepad"></i><span>Play</span></div>
    <div class="nav-item" onclick="nav('chat', this)"><i class="fas fa-comments"></i><span>Chat</span></div>
    <div class="nav-item" onclick="openAdmin()" style="color:var(--sec)"><i class="fas fa-cog"></i><span>Set</span></div>
  </div>

  <div class="main">
    <div class="header">
      <div class="flight-info" id="ui_fn">CX 882</div>
      <div class="stats-bar">
        <div><i class="fas fa-user"></i> <b id="ui_seat">---</b></div>
        <div><i class="fas fa-clock"></i> <b id="ui_rem">00:00</b></div>
      </div>
    </div>

    <div id="home" class="view active">
      <h1>Welcome Aboard</h1>
      <p style="color:#888" id="ui_al">Airline</p>
      <div style="background:#111; padding:20px; border-radius:10px; border:1px solid #333; margin-top:20px;">
        <h3 style="margin-top:0">Flight Status</h3>
        <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-size:12px; color:#888;">
          <span>ORIGIN</span><span>DESTINATION</span>
        </div>
        <div style="height:4px; background:#333; position:relative; border-radius:2px;">
           <div id="bar_fill" style="width:10%; height:100%; background:var(--sec); position:absolute;"></div>
        </div>
        <div style="text-align:center; margin-top:15px; font-size:24px;" id="ui_spd">900 km/h</div>
      </div>
    </div>

    <div id="watch" class="view">
      <h2>Movies</h2>
      <div class="grid" id="m_grid"></div>
    </div>

    <div id="game" class="view">
      <h2>Arcade</h2>
      <div class="grid" id="g_grid"></div>
    </div>

    <div id="chat" class="view">
      <h2>Passenger Link</h2>
      <div class="chat-box" id="c_box">
        <div class="chat-msg" style="color:#666; text-align:center">--- Welcome to Flight Chat ---</div>
      </div>
      <div class="chat-input-area">
        <input id="c_in" placeholder="Say hello...">
        <button onclick="sendChat()">SEND</button>
      </div>
    </div>

  </div>
</div>

<div class="admin-overlay" id="adm">
  <div class="adm-header">
    <h3 style="margin:0; color:#fff">SETTINGS</h3>
    <button class="btn" style="background:#333; width:auto; padding:5px 15px;" onclick="closeAdmin()">CLOSE X</button>
  </div>
  <div class="adm-content">
    
    <div class="adm-group" style="border-color:var(--sec);">
      <h4>MY PROFILE</h4>
      <div class="inp-row">
        <label>My Seat Number (Visible in Chat)</label>
        <input id="my_seat_in" placeholder="e.g. 42A" onchange="saveSeat()">
      </div>
    </div>

    <div class="adm-group">
      <h4>CREW CONTROLS (ADMIN)</h4>
      <div class="inp-row"><label>Airline Name</label><input id="s_al"></div>
      <div class="inp-row"><label>Flight Number</label><input id="s_fn"></div>
      <div class="inp-row"><label>Logo URL</label><input id="s_lg"></div>
      <hr style="border-color:#333; margin:15px 0">
      <div class="inp-row"><label>Flight Progress (%)</label><input type="range" id="s_pr" min="0" max="100" oninput="live(this.value)"></div>
      <div class="inp-row"><label>Speed</label><input id="s_sp"></div>
      <button class="btn" onclick="saveCrew()">UPDATE FLIGHT</button>
    </div>

  </div>
</div>

<div class="vid-mod" id="vid">
  <div class="vid-head"><button class="btn" style="width:auto; background:#333" onclick="clsVid()">CLOSE</button></div>
  <iframe id="ifr" allow="autoplay; fullscreen"></iframe>
</div>

<script>
// === CONFIGURATION ===
const C = { apiKey: "AIzaSyBiabDx61thAOm_A-_2x_mC9Nb9gArRCns", authDomain: "flight-ui.firebaseapp.com", projectId: "flight-ui", appId: "1:507585547506:web:a2f401ddda5055b59ed46b" };

const MOVIES = [
  {t:"Top Gun", i:"https://upload.wikimedia.org/wikipedia/en/1/13/Top_Gun_Maverick_Poster.jpg", u:"https://www.youtube.com/embed/qSqVVzvW13s?autoplay=1"},
  {t:"Interstellar", i:"https://upload.wikimedia.org/wikipedia/en/b/bc/Interstellar_film_poster.jpg", u:"https://www.youtube.com/embed/zSWdZVtXT7E?autoplay=1"},
  {t:"Nature", i:"https://upload.wikimedia.org/wikipedia/commons/thumb/c/c8/Altja_j%C3%B5gi_Lahemaal.jpg/800px-Altja_j%C3%B5gi_Lahemaal.jpg", u:"https://www.youtube.com/embed/JkaxUblCGz0?autoplay=1"}
];

const GAMES = [
  {t:"Minecraft Classic", i:"https://upload.wikimedia.org/wikipedia/en/5/51/Minecraft_cover.png", u:"https://classic.minecraft.net/"},
  {t:"Space Invaders", i:"https://upload.wikimedia.org/wikipedia/en/thumb/5/56/Space_Invaders_Arcade.png/220px-Space_Invaders_Arcade.png", u:"https://freeinvaders.org/"}
];

let db, r, chatR;
let mySeat = localStorage.getItem('mySeat') || "Seat ??";

function init(){
  try{
    firebase.initializeApp(C);
    db=firebase.database();
    r=db.ref('v5/flight');
    chatR=db.ref('v5/chat');

    // Load Saved Seat
    document.getElementById('my_seat_in').value = mySeat;
    document.getElementById('ui_seat').innerText = mySeat;

    // Listen to Flight Data
    r.child('info').on('value', s=>{
      let v=s.val(); if(!v)return;
      document.getElementById('ui_fn').innerText = v.fn;
      document.getElementById('ui_al').innerText = v.al;
      document.getElementById('ui_logo').src = v.lg;
      document.getElementById('s_fn').value = v.fn;
      document.getElementById('s_al').value = v.al;
      document.getElementById('s_lg').value = v.lg;
    });

    r.child('stat').on('value', s=>{
      let v=s.val(); if(!v)return;
      document.getElementById('ui_spd').innerText = v.sp + " km/h";
      document.getElementById('ui_rem').innerText = v.rm;
      document.getElementById('bar_fill').style.width = (v.pr||0) + "%";
      document.getElementById('s_pr').value = v.pr;
      document.getElementById('s_sp').value = v.sp;
    });

    // Listen to Chat
    chatR.limitToLast(20).on('child_added', s=>{
      let v=s.val();
      let d = document.getElementById('c_box');
      d.innerHTML += `<div class="chat-msg"><b>${v.u}:</b> ${v.m}</div>`;
      d.scrollTop = d.scrollHeight;
    });

    renderMedia();
  }catch(e){console.log(e)}
}

// === ACTIONS ===
function nav(p, e){
  document.querySelectorAll('.view').forEach(x=>x.classList.remove('active'));
  document.getElementById(p).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(x=>x.classList.remove('active'));
  e.classList.add('active');
}

function openAdmin(){ document.getElementById('adm').classList.add('open'); }
function closeAdmin(){ document.getElementById('adm').classList.remove('open'); }

// Seat Logic
function saveSeat(){
  let s = document.getElementById('my_seat_in').value;
  if(s){
    mySeat = s;
    localStorage.setItem('mySeat', s);
    document.getElementById('ui_seat').innerText = s;
  }
}

// Crew Logic
function saveCrew(){
  r.child('info').set({
    al: document.getElementById('s_al').value,
    fn: document.getElementById('s_fn').value,
    lg: document.getElementById('s_lg').value
  });
  r.child('stat').update({
    sp: document.getElementById('s_sp').value,
    pr: document.getElementById('s_pr').value
  });
  closeAdmin();
}
function live(v){ r.child('stat').update({pr: v}); }

// Chat Logic
function sendChat(){
  let i = document.getElementById('c_in');
  let txt = i.value;
  if(!txt) return;
  chatR.push({ u: mySeat, m: txt });
  i.value = "";
}

// Media Logic
function renderMedia(){
  document.getElementById('m_grid').innerHTML = MOVIES.map(m=>`
    <div class="card" onclick="play('${m.u}')">
      <img src="${m.i}"><div class="card-info">${m.t}</div>
    </div>`).join('');
    
  document.getElementById('g_grid').innerHTML = GAMES.map(g=>`
    <div class="card" onclick="play('${g.u}')">
      <div class="game-badge">PLAY</div>
      <img src="${g.i}"><div class="card-info">${g.t}</div>
    </div>`).join('');
}

function play(u){ document.getElementById('vid').style.display='flex'; document.getElementById('ifr').src=u; }
function clsVid(){ document.getElementById('vid').style.display='none'; document.getElementById('ifr').src=''; }

window.onload=init;
</script>
</body>
</html>
